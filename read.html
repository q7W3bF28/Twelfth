<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>看漫画 - 漫画分享网站</title>
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>📖</text></svg>">
</head>
<body>
    <div class="loading-screen" id="loading-screen">
        <div class="loading-spinner"></div>
        <p>加载中...</p>
    </div>
    
    <div class="container">
        <header>
            <h1>看漫画</h1>
            <button id="back-btn" class="secondary-btn">← 返回首页</button>
        </header>
        
        <main>
            <div class="bookcase-selection">
                <h2>1. 选择一个书柜</h2>
                <p class="hint">点击书柜查看其中的漫画</p>
                <div class="bookcase-grid" id="bookcase-grid"></div>
            </div>
            
            <div class="password-section" id="password-section" style="display: none;">
                <h2>2. 输入书柜密码</h2>
                <div class="password-container">
                    <input type="password" 
                           id="password-input" 
                           placeholder="请输入6位密码" 
                           maxlength="6"
                           autocomplete="off">
                    <button id="toggle-password" class="password-toggle" title="显示/隐藏密码">👁️</button>
                    <button id="verify-btn" class="primary-btn">🔓 验证密码</button>
                </div>
                <p class="password-hint">💡 初始密码: 123456</p>
                <p class="password-hint">⚠️ 如果密码错误，请重新选择书柜以获取最新密码</p>
                <div class="error-message" id="error-message" style="display: none;">
                    ❌ 密码错误，请重新输入
                </div>
            </div>
            
            <div class="comic-viewer" id="comic-viewer" style="display: none;">
                <div class="viewer-header">
                    <h2 id="comic-title">漫画标题</h2>
                    <div class="viewer-controls">
                        <button id="prev-page" class="control-btn" title="上一页 (←)">◀</button>
                        <span id="page-counter">1/1</span>
                        <button id="next-page" class="control-btn" title="下一页 (→)">▶</button>
                        
                        <div class="control-separator"></div>
                        
                        <button id="zoom-out-btn" class="control-btn" title="缩小 (-)">➖</button>
                        <span id="zoom-percent">100%</span>
                        <button id="zoom-in-btn" class="control-btn" title="放大 (+)">➕</button>
                        
                        <div class="control-separator"></div>
                        
                        <button id="fit-screen-btn" class="control-btn" title="适应屏幕 (0)">⛶</button>
                        <button id="rotate-btn" class="control-btn" title="旋转 (r)">🔄</button>
                        <button id="fullscreen-btn" class="control-btn" title="全屏 (f)">⛶</button>
                        <button id="night-mode-btn" class="control-btn" title="夜间模式 (n)">🌙</button>
                        <button id="close-viewer" class="control-btn" title="关闭 (Esc)">✕</button>
                    </div>
                </div>
                
                <div class="viewer-container">
                    <div id="loading-indicator" class="loading-indicator">
                        <div class="loading-spinner"></div>
                        <p>加载中...</p>
                    </div>
                    <div id="pdf-viewer" class="pdf-viewer">
                        <canvas id="pdf-canvas"></canvas>
                    </div>
                    <div id="zip-viewer" class="zip-viewer">
                        <img id="comic-image" src="" alt="漫画页面">
                    </div>
                </div>
                
                <div class="viewer-footer">
                    <div class="password-info">
                        <span>📖 书柜密码: </span>
                        <span id="current-password" class="password-display"></span>
                        <span id="password-update-indicator" class="update-indicator">(已更新)</span>
                    </div>
                </div>
            </div>
        </main>
        
        <footer>
            <p>© 2025 漫画分享网站 | 使用 GoFile.io 和 Ably 技术</p>
        </footer>
    </div>
    
    <div class="reader-progress" id="reader-progress">
        <div class="reader-progress-bar" id="reader-progress-bar"></div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdn.ably.com/lib/ably.min-1.js"></script>
    <script src="assets/js/gofile.js"></script>
    <script src="assets/js/ably.js"></script>
    <script src="assets/js/pdf-viewer.js"></script>
    <script src="assets/js/zip-viewer.js"></script>
    <script src="assets/js/main.js"></script>
</body>
</html>